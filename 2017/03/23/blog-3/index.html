<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JS实现密码加密 | 不怕麻烦的鹿丸的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1、base64加密在页面中引入base64.js文件，调用方法为：">
<meta property="og:type" content="article">
<meta property="og:title" content="JS实现密码加密">
<meta property="og:url" content="https://bupamafandeluwan.github.io/2017/03/23/blog-3/index.html">
<meta property="og:site_name" content="不怕麻烦的鹿丸的博客">
<meta property="og:description" content="1、base64加密在页面中引入base64.js文件，调用方法为：">
<meta property="og:updated_time" content="2017-03-23T14:17:53.835Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JS实现密码加密">
<meta name="twitter:description" content="1、base64加密在页面中引入base64.js文件，调用方法为：">
  
    <link rel="alternate" href="/atom.xml" title="不怕麻烦的鹿丸的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">不怕麻烦的鹿丸的博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">一天进步一点</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://bupamafandeluwan.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-blog-3" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/23/blog-3/" class="article-date">
  <time datetime="2017-03-23T12:27:12.000Z" itemprop="datePublished">2017-03-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/前端/">前端</a>►<a class="article-category-link" href="/categories/前端/加密/">加密</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JS实现密码加密
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1、base64加密"><a href="#1、base64加密" class="headerlink" title="1、base64加密"></a>1、base64加密</h2><p>在页面中引入base64.js文件，调用方法为：<br><a id="more"></a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">&lt;title&gt;base64加密&lt;/title&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;base64.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;  </div><div class="line">        var b = new Base64();  </div><div class="line">        var str = b.encode(&quot;admin:admin&quot;);  </div><div class="line">        alert(&quot;base64 encode:&quot; + str);  </div><div class="line">　　　　　//解密</div><div class="line">        str = b.decode(str);  </div><div class="line">        alert(&quot;base64 decode:&quot; + str);  </div><div class="line">&lt;/script&gt;  </div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<h2 id="2、md5加密"><a href="#2、md5加密" class="headerlink" title="2、md5加密"></a>2、md5加密</h2><p>在页面中引用md5.js文件，调用方法为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">&lt;title&gt;md5加密&lt;/title&gt;</div><div class="line">&lt;script type=&quot;text/ecmascript&quot; src=&quot;md5.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;  </div><div class="line">  var hash = hex_md5(&quot;123dafd&quot;);</div><div class="line">    alert(hash)</div><div class="line">&lt;/script&gt;  </div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<h2 id="3、sha1加密"><a href="#3、sha1加密" class="headerlink" title="3、sha1加密"></a>3、sha1加密</h2><p>据说这是最安全的加密</p>
<p>页面中引入sha1.js，调用方法为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE HTML&gt;</div><div class="line">&lt;html&gt;</div><div class="line">&lt;head&gt;</div><div class="line">&lt;meta charset=&quot;utf-8&quot;&gt;</div><div class="line">&lt;title&gt;sha1加密&lt;/title&gt;</div><div class="line">&lt;script type=&quot;text/ecmascript&quot; src=&quot;sha1.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;script type=&quot;text/javascript&quot;&gt;</div><div class="line">  var sha = hex_sha1(&apos;mima123465&apos;)</div><div class="line">    alert(sha)   </div><div class="line">&lt;/script&gt;  </div><div class="line">&lt;/head&gt;</div><div class="line"></div><div class="line">&lt;body&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure></p>
<h2 id="加密的js文件"><a href="#加密的js文件" class="headerlink" title="加密的js文件"></a>加密的js文件</h2><h3 id="sha1-js"><a href="#sha1-js" class="headerlink" title="sha1.js"></a>sha1.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div></pre></td><td class="code"><pre><div class="line">/*   </div><div class="line"> *   A   JavaScript   implementation   of   the   Secure   Hash   Algorithm,   SHA-1,   as   defined   </div><div class="line"> *   in   FIPS   PUB   180-1   </div><div class="line"> *   Version   2.1-BETA   Copyright   Paul   Johnston   2000   -   2002.   </div><div class="line"> *   Other   contributors:   Greg   Holt,   Andrew   Kepert,   Ydnar,   Lostinet   </div><div class="line"> *   Distributed   under   the   BSD   License   </div><div class="line"> *   See   http://pajhome.org.uk/crypt/md5   for   details.   </div><div class="line"> */</div><div class="line">/*   </div><div class="line"> *   Configurable   variables.   You   may   need   to   tweak   these   to   be   compatible   with   </div><div class="line"> *   the   server-side,   but   the   defaults   work   in   most   cases.   </div><div class="line"> */</div><div class="line">var hexcase = 0; /*   hex   output   format.   0   -   lowercase;   1   -   uppercase                 */</div><div class="line">var b64pad = &quot;&quot;; /*   base-64   pad   character.   &quot;=&quot;   for   strict   RFC   compliance       */</div><div class="line">var chrsz = 8; /*   bits   per   input   character.   8   -   ASCII;   16   -   Unicode             */</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   These   are   the   functions   you&apos;ll   usually   want   to   call   </div><div class="line"> *   They   take   string   arguments   and   return   either   hex   or   base-64   encoded   strings   </div><div class="line"> */</div><div class="line">function hex_sha1(s) &#123;</div><div class="line">    return binb2hex(core_sha1(str2binb(s), s.length * chrsz));</div><div class="line">&#125;</div><div class="line"></div><div class="line">function b64_sha1(s) &#123;</div><div class="line">    return binb2b64(core_sha1(str2binb(s), s.length * chrsz));</div><div class="line">&#125;</div><div class="line"></div><div class="line">function str_sha1(s) &#123;</div><div class="line">    return binb2str(core_sha1(str2binb(s), s.length * chrsz));</div><div class="line">&#125;</div><div class="line"></div><div class="line">function hex_hmac_sha1(key, data) &#123;</div><div class="line">    return binb2hex(core_hmac_sha1(key, data));</div><div class="line">&#125;</div><div class="line"></div><div class="line">function b64_hmac_sha1(key, data) &#123;</div><div class="line">    return binb2b64(core_hmac_sha1(key, data));</div><div class="line">&#125;</div><div class="line"></div><div class="line">function str_hmac_sha1(key, data) &#123;</div><div class="line">    return binb2str(core_hmac_sha1(key, data));</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Perform   a   simple   self-test   to   see   if   the   VM   is   working   </div><div class="line"> */</div><div class="line">function sha1_vm_test() &#123;</div><div class="line">    return hex_sha1(&quot;abc&quot;) == &quot;a9993e364706816aba3e25717850c26c9cd0d89d&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Calculate   the   SHA-1   of   an   array   of   big-endian   words,   and   a   bit   length   </div><div class="line"> */</div><div class="line">function core_sha1(x, len) &#123;</div><div class="line">    /*   append   padding   */</div><div class="line">    x[len &gt;&gt; 5] |= 0x80 &lt;&lt; (24 - len % 32);</div><div class="line">    x[((len + 64 &gt;&gt; 9) &lt;&lt; 4) + 15] = len;</div><div class="line"></div><div class="line">    var w = Array(80);</div><div class="line">    var a = 1732584193;</div><div class="line">    var b = -271733879;</div><div class="line">    var c = -1732584194;</div><div class="line">    var d = 271733878;</div><div class="line">    var e = -1009589776;</div><div class="line"></div><div class="line">    for (var i = 0; i &lt; x.length; i += 16) &#123;</div><div class="line">        var olda = a;</div><div class="line">        var oldb = b;</div><div class="line">        var oldc = c;</div><div class="line">        var oldd = d;</div><div class="line">        var olde = e;</div><div class="line"></div><div class="line">        for (var j = 0; j &lt; 80; j++) &#123;</div><div class="line">            if (j &lt; 16) w[j] = x[i + j];</div><div class="line">            else w[j] = rol(w[j - 3] ^ w[j - 8] ^ w[j - 14] ^ w[j - 16], 1);</div><div class="line">            var t = safe_add(safe_add(rol(a, 5), sha1_ft(j, b, c, d)), safe_add(safe_add(e, w[j]), sha1_kt(j)));</div><div class="line">            e = d;</div><div class="line">            d = c;</div><div class="line">            c = rol(b, 30);</div><div class="line">            b = a;</div><div class="line">            a = t;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        a = safe_add(a, olda);</div><div class="line">        b = safe_add(b, oldb);</div><div class="line">        c = safe_add(c, oldc);</div><div class="line">        d = safe_add(d, oldd);</div><div class="line">        e = safe_add(e, olde);</div><div class="line">    &#125;</div><div class="line">    return Array(a, b, c, d, e);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Perform   the   appropriate   triplet   combination   function   for   the   current   </div><div class="line"> *   iteration   </div><div class="line"> */</div><div class="line">function sha1_ft(t, b, c, d) &#123;</div><div class="line">    if (t &lt; 20) return (b &amp; c) | ((~b) &amp; d);</div><div class="line">    if (t &lt; 40) return b ^ c ^ d;</div><div class="line">    if (t &lt; 60) return (b &amp; c) | (b &amp; d) | (c &amp; d);</div><div class="line">    return b ^ c ^ d;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Determine   the   appropriate   additive   constant   for   the   current   iteration   </div><div class="line"> */</div><div class="line">function sha1_kt(t) &#123;</div><div class="line">    return (t &lt; 20) ? 1518500249 : (t &lt; 40) ? 1859775393 : (t &lt; 60) ? -1894007588 : -899497514;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Calculate   the   HMAC-SHA1   of   a   key   and   some   data   </div><div class="line"> */</div><div class="line">function core_hmac_sha1(key, data) &#123;</div><div class="line">    var bkey = str2binb(key);</div><div class="line">    if (bkey.length &gt; 16) bkey = core_sha1(bkey, key.length * chrsz);</div><div class="line"></div><div class="line">    var ipad = Array(16),</div><div class="line">        opad = Array(16);</div><div class="line">    for (var i = 0; i &lt; 16; i++) &#123;</div><div class="line">        ipad[i] = bkey[i] ^ 0x36363636;</div><div class="line">        opad[i] = bkey[i] ^ 0x5C5C5C5C;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    var hash = core_sha1(ipad.concat(str2binb(data)), 512 + data.length * chrsz);</div><div class="line">    return core_sha1(opad.concat(hash), 512 + 160);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Add   integers,   wrapping   at   2^32.   This   uses   16-bit   operations   internally   </div><div class="line"> *   to   work   around   bugs   in   some   JS   interpreters.   </div><div class="line"> */</div><div class="line">function safe_add(x, y) &#123;</div><div class="line">    var lsw = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);</div><div class="line">    var msw = (x &gt;&gt; 16) + (y &gt;&gt; 16) + (lsw &gt;&gt; 16);</div><div class="line">    return (msw &lt;&lt; 16) | (lsw &amp; 0xFFFF);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Bitwise   rotate   a   32-bit   number   to   the   left.   </div><div class="line"> */</div><div class="line">function rol(num, cnt) &#123;</div><div class="line">    return (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (32 - cnt));</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Convert   an   8-bit   or   16-bit   string   to   an   array   of   big-endian   words   </div><div class="line"> *   In   8-bit   function,   characters   &gt;255   have   their   hi-byte   silently   ignored.   </div><div class="line"> */</div><div class="line">function str2binb(str) &#123;</div><div class="line">    var bin = Array();</div><div class="line">    var mask = (1 &lt;&lt; chrsz) - 1;</div><div class="line">    for (var i = 0; i &lt; str.length * chrsz; i += chrsz)</div><div class="line">    bin[i &gt;&gt; 5] |= (str.charCodeAt(i / chrsz) &amp; mask) &lt;&lt; (24 - i % 32);</div><div class="line">    return bin;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Convert   an   array   of   big-endian   words   to   a   string   </div><div class="line"> */</div><div class="line">function binb2str(bin) &#123;</div><div class="line">    var str = &quot;&quot;;</div><div class="line">    var mask = (1 &lt;&lt; chrsz) - 1;</div><div class="line">    for (var i = 0; i &lt; bin.length * 32; i += chrsz)</div><div class="line">    str += String.fromCharCode((bin[i &gt;&gt; 5] &gt;&gt;&gt; (24 - i % 32)) &amp; mask);</div><div class="line">    return str;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Convert   an   array   of   big-endian   words   to   a   hex   string.   </div><div class="line"> */</div><div class="line">function binb2hex(binarray) &#123;</div><div class="line">    var hex_tab = hexcase ? &quot;0123456789ABCDEF&quot; : &quot;0123456789abcdef&quot;;</div><div class="line">    var str = &quot;&quot;;</div><div class="line">    for (var i = 0; i &lt; binarray.length * 4; i++) &#123;</div><div class="line">        str += hex_tab.charAt((binarray[i &gt;&gt; 2] &gt;&gt; ((3 - i % 4) * 8 + 4)) &amp; 0xF) + hex_tab.charAt((binarray[i &gt;&gt; 2] &gt;&gt; ((3 - i % 4) * 8)) &amp; 0xF);</div><div class="line">    &#125;</div><div class="line">    return str;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*   </div><div class="line"> *   Convert   an   array   of   big-endian   words   to   a   base-64   string   </div><div class="line"> */</div><div class="line">function binb2b64(binarray) &#123;</div><div class="line">    var tab = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</div><div class="line">    var str = &quot;&quot;;</div><div class="line">    for (var i = 0; i &lt; binarray.length * 4; i += 3) &#123;</div><div class="line">        var triplet = (((binarray[i &gt;&gt; 2] &gt;&gt; 8 * (3 - i % 4)) &amp; 0xFF) &lt;&lt; 16) | (((binarray[i + 1 &gt;&gt; 2] &gt;&gt; 8 * (3 - (i + 1) % 4)) &amp; 0xFF) &lt;&lt; 8) | ((binarray[i + 2 &gt;&gt; 2] &gt;&gt; 8 * (3 - (i + 2) % 4)) &amp; 0xFF);</div><div class="line">        for (var j = 0; j &lt; 4; j++) &#123;</div><div class="line">            if (i * 8 + j * 6 &gt; binarray.length * 32) str += b64pad;</div><div class="line">            else str += tab.charAt((triplet &gt;&gt; 6 * (3 - j)) &amp; 0x3F);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    return str;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="base64-js"><a href="#base64-js" class="headerlink" title="base64.js"></a>base64.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">*</div><div class="line">*  Base64 encode / decode</div><div class="line">*</div><div class="line">*  @author haitao.tu</div><div class="line">*  @date   2010-04-26</div><div class="line">*  @email  tuhaitao@foxmail.com</div><div class="line">*</div><div class="line">*/</div><div class="line"> </div><div class="line">function Base64() &#123;</div><div class="line"> </div><div class="line">    // private property</div><div class="line">    _keyStr = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;;</div><div class="line"> </div><div class="line">    // public method for encoding</div><div class="line">    this.encode = function (input) &#123;</div><div class="line">        var output = &quot;&quot;;</div><div class="line">        var chr1, chr2, chr3, enc1, enc2, enc3, enc4;</div><div class="line">        var i = 0;</div><div class="line">        input = _utf8_encode(input);</div><div class="line">        while (i &lt; input.length) &#123;</div><div class="line">            chr1 = input.charCodeAt(i++);</div><div class="line">            chr2 = input.charCodeAt(i++);</div><div class="line">            chr3 = input.charCodeAt(i++);</div><div class="line">            enc1 = chr1 &gt;&gt; 2;</div><div class="line">            enc2 = ((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4);</div><div class="line">            enc3 = ((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6);</div><div class="line">            enc4 = chr3 &amp; 63;</div><div class="line">            if (isNaN(chr2)) &#123;</div><div class="line">                enc3 = enc4 = 64;</div><div class="line">            &#125; else if (isNaN(chr3)) &#123;</div><div class="line">                enc4 = 64;</div><div class="line">            &#125;</div><div class="line">            output = output +</div><div class="line">            _keyStr.charAt(enc1) + _keyStr.charAt(enc2) +</div><div class="line">            _keyStr.charAt(enc3) + _keyStr.charAt(enc4);</div><div class="line">        &#125;</div><div class="line">        return output;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    // public method for decoding</div><div class="line">    this.decode = function (input) &#123;</div><div class="line">        var output = &quot;&quot;;</div><div class="line">        var chr1, chr2, chr3;</div><div class="line">        var enc1, enc2, enc3, enc4;</div><div class="line">        var i = 0;</div><div class="line">        input = input.replace(/[^A-Za-z0-9\+\/\=]/g, &quot;&quot;);</div><div class="line">        while (i &lt; input.length) &#123;</div><div class="line">            enc1 = _keyStr.indexOf(input.charAt(i++));</div><div class="line">            enc2 = _keyStr.indexOf(input.charAt(i++));</div><div class="line">            enc3 = _keyStr.indexOf(input.charAt(i++));</div><div class="line">            enc4 = _keyStr.indexOf(input.charAt(i++));</div><div class="line">            chr1 = (enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);</div><div class="line">            chr2 = ((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);</div><div class="line">            chr3 = ((enc3 &amp; 3) &lt;&lt; 6) | enc4;</div><div class="line">            output = output + String.fromCharCode(chr1);</div><div class="line">            if (enc3 != 64) &#123;</div><div class="line">                output = output + String.fromCharCode(chr2);</div><div class="line">            &#125;</div><div class="line">            if (enc4 != 64) &#123;</div><div class="line">                output = output + String.fromCharCode(chr3);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        output = _utf8_decode(output);</div><div class="line">        return output;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    // private method for UTF-8 encoding</div><div class="line">    _utf8_encode = function (string) &#123;</div><div class="line">        string = string.replace(/\r\n/g,&quot;\n&quot;);</div><div class="line">        var utftext = &quot;&quot;;</div><div class="line">        for (var n = 0; n &lt; string.length; n++) &#123;</div><div class="line">            var c = string.charCodeAt(n);</div><div class="line">            if (c &lt; 128) &#123;</div><div class="line">                utftext += String.fromCharCode(c);</div><div class="line">            &#125; else if((c &gt; 127) &amp;&amp; (c &lt; 2048)) &#123;</div><div class="line">                utftext += String.fromCharCode((c &gt;&gt; 6) | 192);</div><div class="line">                utftext += String.fromCharCode((c &amp; 63) | 128);</div><div class="line">            &#125; else &#123;</div><div class="line">                utftext += String.fromCharCode((c &gt;&gt; 12) | 224);</div><div class="line">                utftext += String.fromCharCode(((c &gt;&gt; 6) &amp; 63) | 128);</div><div class="line">                utftext += String.fromCharCode((c &amp; 63) | 128);</div><div class="line">            &#125;</div><div class="line"> </div><div class="line">        &#125;</div><div class="line">        return utftext;</div><div class="line">    &#125;</div><div class="line"> </div><div class="line">    // private method for UTF-8 decoding</div><div class="line">    _utf8_decode = function (utftext) &#123;</div><div class="line">        var string = &quot;&quot;;</div><div class="line">        var i = 0;</div><div class="line">        var c = c1 = c2 = 0;</div><div class="line">        while ( i &lt; utftext.length ) &#123;</div><div class="line">            c = utftext.charCodeAt(i);</div><div class="line">            if (c &lt; 128) &#123;</div><div class="line">                string += String.fromCharCode(c);</div><div class="line">                i++;</div><div class="line">            &#125; else if((c &gt; 191) &amp;&amp; (c &lt; 224)) &#123;</div><div class="line">                c2 = utftext.charCodeAt(i+1);</div><div class="line">                string += String.fromCharCode(((c &amp; 31) &lt;&lt; 6) | (c2 &amp; 63));</div><div class="line">                i += 2;</div><div class="line">            &#125; else &#123;</div><div class="line">                c2 = utftext.charCodeAt(i+1);</div><div class="line">                c3 = utftext.charCodeAt(i+2);</div><div class="line">                string += String.fromCharCode(((c &amp; 15) &lt;&lt; 12) | ((c2 &amp; 63) &lt;&lt; 6) | (c3 &amp; 63));</div><div class="line">                i += 3;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        return string;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="md5-js"><a href="#md5-js" class="headerlink" title="md5.js"></a>md5.js</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line"> * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message</div><div class="line"> * Digest Algorithm, as defined in RFC 1321.</div><div class="line"> * Version 2.1 Copyright (C) Paul Johnston 1999 - 2002.</div><div class="line"> * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet</div><div class="line"> * Distributed under the BSD License</div><div class="line"> * See http://pajhome.org.uk/crypt/md5 for more info.</div><div class="line"> */</div><div class="line"></div><div class="line">/*</div><div class="line"> * Configurable variables. You may need to tweak these to be compatible with</div><div class="line"> * the server-side, but the defaults work in most cases.</div><div class="line"> */</div><div class="line">var hexcase = 0;  /* hex output format. 0 - lowercase; 1 - uppercase        */</div><div class="line">var b64pad  = &quot;&quot;; /* base-64 pad character. &quot;=&quot; for strict RFC compliance   */</div><div class="line">var chrsz   = 8;  /* bits per input character. 8 - ASCII; 16 - Unicode      */</div><div class="line"></div><div class="line">/*</div><div class="line"> * These are the functions you&apos;ll usually want to call</div><div class="line"> * They take string arguments and return either hex or base-64 encoded strings</div><div class="line"> */</div><div class="line">function hex_md5(s)&#123; return binl2hex(core_md5(str2binl(s), s.length * chrsz));&#125;</div><div class="line">function b64_md5(s)&#123; return binl2b64(core_md5(str2binl(s), s.length * chrsz));&#125;</div><div class="line">function str_md5(s)&#123; return binl2str(core_md5(str2binl(s), s.length * chrsz));&#125;</div><div class="line">function hex_hmac_md5(key, data) &#123; return binl2hex(core_hmac_md5(key, data)); &#125;</div><div class="line">function b64_hmac_md5(key, data) &#123; return binl2b64(core_hmac_md5(key, data)); &#125;</div><div class="line">function str_hmac_md5(key, data) &#123; return binl2str(core_hmac_md5(key, data)); &#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Perform a simple self-test to see if the VM is working</div><div class="line"> */</div><div class="line">function md5_vm_test()</div><div class="line">&#123;</div><div class="line">  return hex_md5(&quot;abc&quot;) == &quot;900150983cd24fb0d6963f7d28e17f72&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Calculate the MD5 of an array of little-endian words, and a bit length</div><div class="line"> */</div><div class="line">function core_md5(x, len)</div><div class="line">&#123;</div><div class="line">  /* append padding */</div><div class="line">  x[len &gt;&gt; 5] |= 0x80 &lt;&lt; ((len) % 32);</div><div class="line">  x[(((len + 64) &gt;&gt;&gt; 9) &lt;&lt; 4) + 14] = len;</div><div class="line"></div><div class="line">  var a =  1732584193;</div><div class="line">  var b = -271733879;</div><div class="line">  var c = -1732584194;</div><div class="line">  var d =  271733878;</div><div class="line"></div><div class="line">  for(var i = 0; i &lt; x.length; i += 16)</div><div class="line">  &#123;</div><div class="line">    var olda = a;</div><div class="line">    var oldb = b;</div><div class="line">    var oldc = c;</div><div class="line">    var oldd = d;</div><div class="line"></div><div class="line">    a = md5_ff(a, b, c, d, x[i+ 0], 7 , -680876936);</div><div class="line">    d = md5_ff(d, a, b, c, x[i+ 1], 12, -389564586);</div><div class="line">    c = md5_ff(c, d, a, b, x[i+ 2], 17,  606105819);</div><div class="line">    b = md5_ff(b, c, d, a, x[i+ 3], 22, -1044525330);</div><div class="line">    a = md5_ff(a, b, c, d, x[i+ 4], 7 , -176418897);</div><div class="line">    d = md5_ff(d, a, b, c, x[i+ 5], 12,  1200080426);</div><div class="line">    c = md5_ff(c, d, a, b, x[i+ 6], 17, -1473231341);</div><div class="line">    b = md5_ff(b, c, d, a, x[i+ 7], 22, -45705983);</div><div class="line">    a = md5_ff(a, b, c, d, x[i+ 8], 7 ,  1770035416);</div><div class="line">    d = md5_ff(d, a, b, c, x[i+ 9], 12, -1958414417);</div><div class="line">    c = md5_ff(c, d, a, b, x[i+10], 17, -42063);</div><div class="line">    b = md5_ff(b, c, d, a, x[i+11], 22, -1990404162);</div><div class="line">    a = md5_ff(a, b, c, d, x[i+12], 7 ,  1804603682);</div><div class="line">    d = md5_ff(d, a, b, c, x[i+13], 12, -40341101);</div><div class="line">    c = md5_ff(c, d, a, b, x[i+14], 17, -1502002290);</div><div class="line">    b = md5_ff(b, c, d, a, x[i+15], 22,  1236535329);</div><div class="line"></div><div class="line">    a = md5_gg(a, b, c, d, x[i+ 1], 5 , -165796510);</div><div class="line">    d = md5_gg(d, a, b, c, x[i+ 6], 9 , -1069501632);</div><div class="line">    c = md5_gg(c, d, a, b, x[i+11], 14,  643717713);</div><div class="line">    b = md5_gg(b, c, d, a, x[i+ 0], 20, -373897302);</div><div class="line">    a = md5_gg(a, b, c, d, x[i+ 5], 5 , -701558691);</div><div class="line">    d = md5_gg(d, a, b, c, x[i+10], 9 ,  38016083);</div><div class="line">    c = md5_gg(c, d, a, b, x[i+15], 14, -660478335);</div><div class="line">    b = md5_gg(b, c, d, a, x[i+ 4], 20, -405537848);</div><div class="line">    a = md5_gg(a, b, c, d, x[i+ 9], 5 ,  568446438);</div><div class="line">    d = md5_gg(d, a, b, c, x[i+14], 9 , -1019803690);</div><div class="line">    c = md5_gg(c, d, a, b, x[i+ 3], 14, -187363961);</div><div class="line">    b = md5_gg(b, c, d, a, x[i+ 8], 20,  1163531501);</div><div class="line">    a = md5_gg(a, b, c, d, x[i+13], 5 , -1444681467);</div><div class="line">    d = md5_gg(d, a, b, c, x[i+ 2], 9 , -51403784);</div><div class="line">    c = md5_gg(c, d, a, b, x[i+ 7], 14,  1735328473);</div><div class="line">    b = md5_gg(b, c, d, a, x[i+12], 20, -1926607734);</div><div class="line"></div><div class="line">    a = md5_hh(a, b, c, d, x[i+ 5], 4 , -378558);</div><div class="line">    d = md5_hh(d, a, b, c, x[i+ 8], 11, -2022574463);</div><div class="line">    c = md5_hh(c, d, a, b, x[i+11], 16,  1839030562);</div><div class="line">    b = md5_hh(b, c, d, a, x[i+14], 23, -35309556);</div><div class="line">    a = md5_hh(a, b, c, d, x[i+ 1], 4 , -1530992060);</div><div class="line">    d = md5_hh(d, a, b, c, x[i+ 4], 11,  1272893353);</div><div class="line">    c = md5_hh(c, d, a, b, x[i+ 7], 16, -155497632);</div><div class="line">    b = md5_hh(b, c, d, a, x[i+10], 23, -1094730640);</div><div class="line">    a = md5_hh(a, b, c, d, x[i+13], 4 ,  681279174);</div><div class="line">    d = md5_hh(d, a, b, c, x[i+ 0], 11, -358537222);</div><div class="line">    c = md5_hh(c, d, a, b, x[i+ 3], 16, -722521979);</div><div class="line">    b = md5_hh(b, c, d, a, x[i+ 6], 23,  76029189);</div><div class="line">    a = md5_hh(a, b, c, d, x[i+ 9], 4 , -640364487);</div><div class="line">    d = md5_hh(d, a, b, c, x[i+12], 11, -421815835);</div><div class="line">    c = md5_hh(c, d, a, b, x[i+15], 16,  530742520);</div><div class="line">    b = md5_hh(b, c, d, a, x[i+ 2], 23, -995338651);</div><div class="line"></div><div class="line">    a = md5_ii(a, b, c, d, x[i+ 0], 6 , -198630844);</div><div class="line">    d = md5_ii(d, a, b, c, x[i+ 7], 10,  1126891415);</div><div class="line">    c = md5_ii(c, d, a, b, x[i+14], 15, -1416354905);</div><div class="line">    b = md5_ii(b, c, d, a, x[i+ 5], 21, -57434055);</div><div class="line">    a = md5_ii(a, b, c, d, x[i+12], 6 ,  1700485571);</div><div class="line">    d = md5_ii(d, a, b, c, x[i+ 3], 10, -1894986606);</div><div class="line">    c = md5_ii(c, d, a, b, x[i+10], 15, -1051523);</div><div class="line">    b = md5_ii(b, c, d, a, x[i+ 1], 21, -2054922799);</div><div class="line">    a = md5_ii(a, b, c, d, x[i+ 8], 6 ,  1873313359);</div><div class="line">    d = md5_ii(d, a, b, c, x[i+15], 10, -30611744);</div><div class="line">    c = md5_ii(c, d, a, b, x[i+ 6], 15, -1560198380);</div><div class="line">    b = md5_ii(b, c, d, a, x[i+13], 21,  1309151649);</div><div class="line">    a = md5_ii(a, b, c, d, x[i+ 4], 6 , -145523070);</div><div class="line">    d = md5_ii(d, a, b, c, x[i+11], 10, -1120210379);</div><div class="line">    c = md5_ii(c, d, a, b, x[i+ 2], 15,  718787259);</div><div class="line">    b = md5_ii(b, c, d, a, x[i+ 9], 21, -343485551);</div><div class="line"></div><div class="line">    a = safe_add(a, olda);</div><div class="line">    b = safe_add(b, oldb);</div><div class="line">    c = safe_add(c, oldc);</div><div class="line">    d = safe_add(d, oldd);</div><div class="line">  &#125;</div><div class="line">  return Array(a, b, c, d);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * These functions implement the four basic operations the algorithm uses.</div><div class="line"> */</div><div class="line">function md5_cmn(q, a, b, x, s, t)</div><div class="line">&#123;</div><div class="line">  return safe_add(bit_rol(safe_add(safe_add(a, q), safe_add(x, t)), s),b);</div><div class="line">&#125;</div><div class="line">function md5_ff(a, b, c, d, x, s, t)</div><div class="line">&#123;</div><div class="line">  return md5_cmn((b &amp; c) | ((~b) &amp; d), a, b, x, s, t);</div><div class="line">&#125;</div><div class="line">function md5_gg(a, b, c, d, x, s, t)</div><div class="line">&#123;</div><div class="line">  return md5_cmn((b &amp; d) | (c &amp; (~d)), a, b, x, s, t);</div><div class="line">&#125;</div><div class="line">function md5_hh(a, b, c, d, x, s, t)</div><div class="line">&#123;</div><div class="line">  return md5_cmn(b ^ c ^ d, a, b, x, s, t);</div><div class="line">&#125;</div><div class="line">function md5_ii(a, b, c, d, x, s, t)</div><div class="line">&#123;</div><div class="line">  return md5_cmn(c ^ (b | (~d)), a, b, x, s, t);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Calculate the HMAC-MD5, of a key and some data</div><div class="line"> */</div><div class="line">function core_hmac_md5(key, data)</div><div class="line">&#123;</div><div class="line">  var bkey = str2binl(key);</div><div class="line">  if(bkey.length &gt; 16) bkey = core_md5(bkey, key.length * chrsz);</div><div class="line"></div><div class="line">  var ipad = Array(16), opad = Array(16);</div><div class="line">  for(var i = 0; i &lt; 16; i++)</div><div class="line">  &#123;</div><div class="line">    ipad[i] = bkey[i] ^ 0x36363636;</div><div class="line">    opad[i] = bkey[i] ^ 0x5C5C5C5C;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  var hash = core_md5(ipad.concat(str2binl(data)), 512 + data.length * chrsz);</div><div class="line">  return core_md5(opad.concat(hash), 512 + 128);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Add integers, wrapping at 2^32. This uses 16-bit operations internally</div><div class="line"> * to work around bugs in some JS interpreters.</div><div class="line"> */</div><div class="line">function safe_add(x, y)</div><div class="line">&#123;</div><div class="line">  var lsw = (x &amp; 0xFFFF) + (y &amp; 0xFFFF);</div><div class="line">  var msw = (x &gt;&gt; 16) + (y &gt;&gt; 16) + (lsw &gt;&gt; 16);</div><div class="line">  return (msw &lt;&lt; 16) | (lsw &amp; 0xFFFF);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Bitwise rotate a 32-bit number to the left.</div><div class="line"> */</div><div class="line">function bit_rol(num, cnt)</div><div class="line">&#123;</div><div class="line">  return (num &lt;&lt; cnt) | (num &gt;&gt;&gt; (32 - cnt));</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Convert a string to an array of little-endian words</div><div class="line"> * If chrsz is ASCII, characters &gt;255 have their hi-byte silently ignored.</div><div class="line"> */</div><div class="line">function str2binl(str)</div><div class="line">&#123;</div><div class="line">  var bin = Array();</div><div class="line">  var mask = (1 &lt;&lt; chrsz) - 1;</div><div class="line">  for(var i = 0; i &lt; str.length * chrsz; i += chrsz)</div><div class="line">    bin[i&gt;&gt;5] |= (str.charCodeAt(i / chrsz) &amp; mask) &lt;&lt; (i%32);</div><div class="line">  return bin;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Convert an array of little-endian words to a string</div><div class="line"> */</div><div class="line">function binl2str(bin)</div><div class="line">&#123;</div><div class="line">  var str = &quot;&quot;;</div><div class="line">  var mask = (1 &lt;&lt; chrsz) - 1;</div><div class="line">  for(var i = 0; i &lt; bin.length * 32; i += chrsz)</div><div class="line">    str += String.fromCharCode((bin[i&gt;&gt;5] &gt;&gt;&gt; (i % 32)) &amp; mask);</div><div class="line">  return str;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Convert an array of little-endian words to a hex string.</div><div class="line"> */</div><div class="line">function binl2hex(binarray)</div><div class="line">&#123;</div><div class="line">  var hex_tab = hexcase ? &quot;0123456789ABCDEF&quot; : &quot;0123456789abcdef&quot;;</div><div class="line">  var str = &quot;&quot;;</div><div class="line">  for(var i = 0; i &lt; binarray.length * 4; i++)</div><div class="line">  &#123;</div><div class="line">    str += hex_tab.charAt((binarray[i&gt;&gt;2] &gt;&gt; ((i%4)*8+4)) &amp; 0xF) +</div><div class="line">           hex_tab.charAt((binarray[i&gt;&gt;2] &gt;&gt; ((i%4)*8  )) &amp; 0xF);</div><div class="line">  &#125;</div><div class="line">  return str;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line"> * Convert an array of little-endian words to a base-64 string</div><div class="line"> */</div><div class="line">function binl2b64(binarray)</div><div class="line">&#123;</div><div class="line">  var tab = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</div><div class="line">  var str = &quot;&quot;;</div><div class="line">  for(var i = 0; i &lt; binarray.length * 4; i += 3)</div><div class="line">  &#123;</div><div class="line">    var triplet = (((binarray[i   &gt;&gt; 2] &gt;&gt; 8 * ( i   %4)) &amp; 0xFF) &lt;&lt; 16)</div><div class="line">                | (((binarray[i+1 &gt;&gt; 2] &gt;&gt; 8 * ((i+1)%4)) &amp; 0xFF) &lt;&lt; 8 )</div><div class="line">                |  ((binarray[i+2 &gt;&gt; 2] &gt;&gt; 8 * ((i+2)%4)) &amp; 0xFF);</div><div class="line">    for(var j = 0; j &lt; 4; j++)</div><div class="line">    &#123;</div><div class="line">      if(i * 8 + j * 6 &gt; binarray.length * 32) str += b64pad;</div><div class="line">      else str += tab.charAt((triplet &gt;&gt; 6*(3-j)) &amp; 0x3F);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  return str;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://bupamafandeluwan.github.io/2017/03/23/blog-3/" data-id="cj0mhasjs0000hkdurpxicdne" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/03/23/blog-2/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          跨域访问的解决方法
        
      </div>
    </a>
  
  
    <a href="/2017/03/23/blog-4/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">JS中闭包原理</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/前端/">前端</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/前端/加密/">加密</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/图片上传/">图片上传</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/跨域/">跨域</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端/闭包/">闭包</a></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/03/23/blog-1/">图片(文件)上传，前后端一次弄明白</a>
          </li>
        
          <li>
            <a href="/2017/03/23/blog-2/">跨域访问的解决方法</a>
          </li>
        
          <li>
            <a href="/2017/03/23/blog-3/">JS实现密码加密</a>
          </li>
        
          <li>
            <a href="/2017/03/23/blog-4/">JS中闭包原理</a>
          </li>
        
          <li>
            <a href="/2017/03/23/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 不怕麻烦的鹿丸<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>